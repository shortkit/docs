---
title: "Playback security"
description: "Configure domain restrictions, signed URLs, and playback security settings for your video content."
keywords: ["security", "playback", "domain", "restrictions", "signed URLs", "tokens", "CDN"]
---

Playback security controls prevent unauthorized access to your video content. ShortKit provides domain allowlisting, signed streaming URLs with time-limited tokens, and referrer validation.

## Overview

ShortKit secures video playback at multiple layers:

- **API authentication** -- All SDK requests require a valid publishable API key (`pk_live_...` or `pk_test_...`) in the `X-API-Key` header
- **Domain restrictions** -- Only requests from allowed domains can play content
- **Signed URLs** -- Streaming URLs include time-limited tokens validated by the CDN
- **Referrer validation** -- Referrer headers are checked against your allowlist

## API authentication

The SDK authenticates with your publishable key on every request. ShortKit uses two key types:

| Key type | Format | Usage |
|----------|--------|-------|
| **Publishable key** | `pk_live_...` / `pk_test_...` | Embedded in the SDK, included in `X-API-Key` header. Read-only access to feed, config, events, and identity endpoints. |
| **Secret key** | `sk_live_...` / `sk_test_...` | Server-side only, used as `Authorization: Bearer` token. Full access to content management, configuration, analytics, and webhooks. |

<Warning>
  Never embed your secret key in client-side code or SDK configuration. Secret keys grant full administrative access and must remain on your server.
</Warning>

### Environment isolation

Keys include an environment prefix to prevent accidental cross-environment usage:

- `pk_live_...` and `sk_live_...` access production content and configuration
- `pk_test_...` and `sk_test_...` access test/staging content and configuration

## Domain allowlist

### Configuration

Add allowed domains via the Admin Portal or API:

<Tabs>
  <Tab title="Admin Portal">
    1. Go to **Settings** then **Playback Restrictions**
    2. Add domains to the allowlist
    3. Save changes
  </Tab>
  <Tab title="API">
    ```bash
    curl -X PUT https://api.shortkit.dev/v1/config/playback-restrictions \
      -H "Authorization: Bearer sk_live_your_secret_key" \
      -H "Content-Type: application/json" \
      -d '{
        "allowedDomains": [
          "yourcompany.com",
          "*.yourcompany.com",
          "staging.yourcompany.com"
        ]
      }'
    ```
  </Tab>
</Tabs>

### Domain formats

| Format | Example | Matches |
|--------|---------|---------|
| Exact domain | `yourcompany.com` | Only `yourcompany.com` |
| Wildcard subdomain | `*.yourcompany.com` | Any subdomain (e.g., `www.`, `app.`, `staging.`) |
| Specific subdomain | `app.yourcompany.com` | Only `app.yourcompany.com` |

### Example configuration

```json
{
  "allowedDomains": [
    "yourcompany.com",
    "*.yourcompany.com",
    "partner-site.com"
  ]
}
```

## Development environments

### Automatic localhost access

In test environments (when using `pk_test_...` keys), the following origins are automatically allowed:

- `localhost`
- `127.0.0.1`
- `*.localhost`

Production environments require explicit domain configuration.

### Environment-specific restrictions

Configure different restrictions per environment:

```bash
# Test environment -- more permissive
curl -X PUT https://api.shortkit.dev/v1/config/playback-restrictions \
  -H "Authorization: Bearer sk_test_your_key" \
  -d '{ "allowedDomains": ["*"] }'

# Production environment -- strict
curl -X PUT https://api.shortkit.dev/v1/config/playback-restrictions \
  -H "Authorization: Bearer sk_live_your_key" \
  -d '{ "allowedDomains": ["yourcompany.com", "*.yourcompany.com"] }'
```

<Warning>
  Never use a wildcard (`*`) domain allowlist in production. This disables domain restrictions entirely.
</Warning>

## Referrer handling

### No-referrer requests

Some scenarios do not send referrer headers:

- Direct URL access in browser address bars
- Certain mobile app WebView implementations
- Privacy-focused browser extensions
- HTTPS to HTTP transitions

Configure how to handle requests with no referrer:

```bash
curl -X PUT https://api.shortkit.dev/v1/config/playback-restrictions \
  -H "Authorization: Bearer sk_live_your_secret_key" \
  -H "Content-Type: application/json" \
  -d '{
    "allowedDomains": ["yourcompany.com"],
    "allowNoReferrer": true
  }'
```

| Setting | Default | Description |
|---------|---------|-------------|
| `allowNoReferrer` | `false` | Allow requests that do not include a referrer header |

<Tip>
  If your native mobile app experiences playback issues, try enabling `allowNoReferrer`. Some WebView implementations do not send referrer headers.
</Tip>

## User agent filtering

Block known scraping and bot user agents:

```bash
curl -X PUT https://api.shortkit.dev/v1/config/playback-restrictions \
  -H "Authorization: Bearer sk_live_your_secret_key" \
  -H "Content-Type: application/json" \
  -d '{
    "allowedDomains": ["yourcompany.com"],
    "allowHighRiskUserAgents": false
  }'
```

When `allowHighRiskUserAgents` is `false`:
- Known scraper user agents are blocked
- Bot traffic is rejected
- Headless browser signatures are blocked

## Signed streaming URLs

### How signing works

1. The SDK requests the feed from the ShortKit API
2. The API returns content items with signed streaming URLs
3. Each signed URL includes:
   - Content identifier
   - Expiration timestamp
   - Organization scope
   - Cryptographic signature
4. The CDN validates the signature before serving video segments

### URL structure

Streaming URLs returned by the feed API include a signed token:

```
https://video.shortkit.dev/v1/streams/{contentId}/manifest.m3u8
  ?token=eyJhbGciOiJIUzI1NiIs...
  &expires=1707048000
```

### Token expiry

Configure how long streaming tokens remain valid:

```bash
curl -X PUT https://api.shortkit.dev/v1/config/cdn \
  -H "Authorization: Bearer sk_live_your_secret_key" \
  -H "Content-Type: application/json" \
  -d '{
    "urlExpiry": 21600
  }'
```

| Setting | Default | Range | Description |
|---------|---------|-------|-------------|
| `urlExpiry` | 21600 (6 hours) | 3600-86400 (1-24 hours) | Token validity period in seconds |

Trade-offs:
- **Shorter expiry** -- More secure, but may cause issues during extended viewing sessions
- **Longer expiry** -- Better user experience, but tokens remain valid longer if intercepted

### Automatic refresh

The SDK automatically handles token refresh:
- Monitors token expiry timestamps
- Requests fresh tokens before expiration
- Refresh is seamless and invisible to users

## Error responses

### Blocked requests

When a playback request is blocked, the response includes a structured error:

```
HTTP/1.1 403 Forbidden
Content-Type: application/json

{
  "error": "PLAYBACK_RESTRICTED",
  "message": "Domain not allowed",
  "code": "DOMAIN_NOT_ALLOWED"
}
```

### Error codes

| Code | Description |
|------|-------------|
| `DOMAIN_NOT_ALLOWED` | Requesting domain is not in the allowlist |
| `TOKEN_EXPIRED` | Signed URL token has expired |
| `TOKEN_INVALID` | Token signature verification failed |
| `REFERRER_BLOCKED` | Referrer header does not match any allowed domain |
| `USER_AGENT_BLOCKED` | User agent matched a blocked pattern |

## Monitoring

### View blocked requests

In the Admin Portal:

1. Go to **Analytics** then **Playback Quality** then **Errors**
2. Filter by error type
3. View blocked request details including requesting domain, user agent, timestamp, and content requested

### Alerts

Set up alerts for unusual block patterns:

1. Go to **Settings** then **Alerts**
2. Create a rule for blocked request rate thresholds
3. Receive notifications when potential unauthorized access or misconfigurations occur

## Testing restrictions

### Verify current configuration

```bash
curl https://api.shortkit.dev/v1/config/playback-restrictions \
  -H "Authorization: Bearer sk_live_your_secret_key"
```

### Test from different domains

Using browser developer tools:

1. Open your site in a browser
2. Attempt to play a video
3. Check the Network tab for request and response details

To verify that unauthorized domains are blocked:

1. Create a test HTML page hosted on a different domain
2. Attempt to embed and play your content
3. Confirm that playback is denied with a `DOMAIN_NOT_ALLOWED` error

## Troubleshooting

### Legitimate traffic being blocked

**Symptom**: Users report that videos do not play.

**Steps**:
1. Verify the domain is in your allowlist
2. Check for typos in domain configuration
3. Review referrer handling settings
4. Check the blocked requests log in the Admin Portal

### Mobile app playback issues

**Symptom**: Videos do not play in a native mobile app.

**Possible causes**:
- WebView not sending referrer headers
- App domain not configured in the allowlist

**Solutions**:
- Enable `allowNoReferrer` for mobile scenarios
- Verify SDK initialization with the correct publishable key

### Partner or embed issues

**Symptom**: Videos do not play on partner sites.

**Solutions**:
- Add the partner domain to your allowlist
- Use a wildcard entry if the partner has multiple subdomains
- Consider issuing separate publishable keys for partners

## Next steps

<Columns cols={2}>
  <Card title="Webhooks" icon="bell" href="/guides/integration/webhooks">
    Receive notifications for content lifecycle events.
  </Card>
  <Card title="Identity management" icon="user" href="/guides/integration/identity-management">
    Configure user identity and cross-device tracking.
  </Card>
</Columns>
